<html>
<head>
<title>functions_statistics.php</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-4.8.6'>
</head>
<body>
<a name='TOP'><h2><a href='../mains.html'>root</a>/functions_statistics.php</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L10'>[^]</a><a href='#L19'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L10' title='Defined at 10.'>showStatsMonth</a>
<li><a href='#L19' title='Defined at 19.'>generateStatsMonth</a>
</ol>
<hr>
<pre>
<a name='L1'>   1 &lt;?
<a name='L2'>   2         <i><font color='green'>/*</font></i>
<a name='L3'>   3 <i><font color='green'>                functions_statistics.php - used by admin module to display statistics</font></i>
<a name='L4'>   4 <i><font color='green'>        */</font></i>
<a name='L5'>   5 
<a name='L6'>   6         <i><font color='green'>/* Displays stats for each month.</font></i>
<a name='L7'>   7 <i><font color='green'>                Will create tblStatistics entries if any are missing for requested page.</font></i>
<a name='L8'>   8 <i><font color='green'>                Hopefully a cron-script updates this regularry, but otherwise the pages will load a bit slow the first times they are accessed</font></i>
<a name='L9'>   9 <i><font color='green'>        */</font></i>
<a name='L10'>  10         <b>function</b> showStatsMonth($<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>, $<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>)
<a name='L11'>  11         <font color='blue'>{</font>
<a name='L12'>  12                 <b>global</b> $<a href='../Y/173.html' title='Multiple used in 576 places.'>db</a>, $<a href='../Y/146.html' title='Multiple used in 316 places.'>config</a>;
<a name='L13'>  13 
<a name='L14'>  14                 <b>if</b> (!<a href='../Y/324.html' title='Multiple used in 225 places.'>is_numeric</a>($<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>) || !<a href='../Y/324.html' title='Multiple used in 225 places.'>is_numeric</a>($<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>)) <b>return</b> <b>false</b>;
<a name='L15'>  15 
<a name='L16'>  16                 <b>echo</b> '&lt;img src="'.$<a href='../Y/146.html' title='Multiple used in 316 places.'>config</a>['core_web_root'].'api/image_statistics.php?y='.$<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>.'&amp;amp;m='.$<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>.<a href='../S/17.html#L63' title='Defined at 63 in functions_general.php.'>getProjectPath</a>().'" alt="Stats"/&gt;';
<a name='L17'>  17         <font color='blue'>}</font>
<a name='L18'>  18 
<a name='L19'>  19         <b>function</b> generateStatsMonth($<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>, $<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>)
<a name='L20'>  20         <font color='blue'>{</font>
<a name='L21'>  21                 <b>global</b> $<a href='../Y/173.html' title='Multiple used in 576 places.'>db</a>;
<a name='L22'>  22 
<a name='L23'>  23                 <b>if</b> (!<a href='../Y/324.html' title='Multiple used in 225 places.'>is_numeric</a>($<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>) || !<a href='../Y/324.html' title='Multiple used in 225 places.'>is_numeric</a>($<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>)) <b>return</b> <b>false</b>;
<a name='L24'>  24 
<a name='L25'>  25                 $<a href='../Y/383.html' title='Multiple used in 3 places.'>month_start</a> = <a href='../Y/377.html' title='Multiple used in 7 places.'>mktime</a>(0, 0, 0, $<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>, 1, $<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>);
<a name='L26'>  26                 $<a href='../Y/381.html' title='Multiple used in 3 places.'>month_days</a>  = <a href='../Y/169.html' title='Multiple used in 14 places.'>date</a>('t', $<a href='../Y/383.html' title='Multiple used in 3 places.'>month_start</a>);
<a name='L27'>  27                 $<a href='../Y/382.html' title='Multiple used in 2 places.'>month_end</a>   = <a href='../Y/377.html' title='Multiple used in 7 places.'>mktime</a>(23,59,59,$<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>, $<a href='../Y/381.html' title='Multiple used in 3 places.'>month_days</a>, $<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>);
<a name='L28'>  28 
<a name='L29'>  29                 <i><font color='green'>//Remove previous entries, if any</font></i>
<a name='L30'>  30                 $<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a> = 'DELETE FROM tblStatistics WHERE time BETWEEN "'.<a href='../S/19.html#L403' title='Defined at 403 in class.DB_Base.php.'>sql_datetime</a>($<a href='../Y/383.html' title='Multiple used in 3 places.'>month_start</a>).'" AND "'.<a href='../S/19.html#L403' title='Defined at 403 in class.DB_Base.php.'>sql_datetime</a>($<a href='../Y/382.html' title='Multiple used in 2 places.'>month_end</a>).'"';
<a name='L31'>  31                 $<a href='../Y/173.html' title='Multiple used in 576 places.'>db</a>-&gt;<a href='../D/305.html' title='Multiple defined in 4 places.'>query</a>($<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a>);
<a name='L32'>  32 
<a name='L33'>  33                 <b>for</b> ($<a href='../Y/171.html' title='Multiple used in 5 places.'>day</a>=1; $<a href='../Y/171.html' title='Multiple used in 5 places.'>day</a>&lt;= $<a href='../Y/381.html' title='Multiple used in 3 places.'>month_days</a>; $<a href='../Y/171.html' title='Multiple used in 5 places.'>day</a>++) <font color='blue'>{</font>
<a name='L34'>  34                         <i><font color='green'>//Generate stats for each day</font></i>
<a name='L35'>  35                         <b>for</b> ($<a href='../Y/267.html' title='Multiple used in 4 places.'>h</a>=0; $<a href='../Y/267.html' title='Multiple used in 4 places.'>h</a>&lt;24; $<a href='../Y/267.html' title='Multiple used in 4 places.'>h</a>++) <font color='blue'>{</font>
<a name='L36'>  36 
<a name='L37'>  37                                 <i><font color='green'>//Count logins</font></i>
<a name='L38'>  38                                 $<a href='../Y/634.html' title='Multiple used in 7 places.'>time_start</a> = <a href='../Y/377.html' title='Multiple used in 7 places.'>mktime</a>($<a href='../Y/267.html' title='Multiple used in 4 places.'>h</a>, 0, 0, $<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>, $<a href='../Y/171.html' title='Multiple used in 5 places.'>day</a>, $<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>);
<a name='L39'>  39                                 $<a href='../Y/629.html' title='Multiple used in 5 places.'>time_end</a>   = <a href='../Y/377.html' title='Multiple used in 7 places.'>mktime</a>($<a href='../Y/267.html' title='Multiple used in 4 places.'>h</a>,59,59, $<a href='../Y/380.html' title='Multiple used in 13 places.'>month</a>, $<a href='../Y/171.html' title='Multiple used in 5 places.'>day</a>, $<a href='../Y/703.html' title='Multiple used in 13 places.'>year</a>);
<a name='L40'>  40                                 $<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a> = 'SELECT COUNT(*) FROM tblLogins WHERE timeCreated BETWEEN "'.<a href='../S/19.html#L403' title='Defined at 403 in class.DB_Base.php.'>sql_datetime</a>($<a href='../Y/634.html' title='Multiple used in 7 places.'>time_start</a>).'" AND "'.<a href='../S/19.html#L403' title='Defined at 403 in class.DB_Base.php.'>sql_datetime</a>($<a href='../Y/629.html' title='Multiple used in 5 places.'>time_end</a>).'"';
<a name='L41'>  41                                 $<a href='../Y/352.html' title='Multiple used in 2 places.'>logins</a> = $<a href='../Y/173.html' title='Multiple used in 576 places.'>db</a>-&gt;<a href='../D/204.html' title='Multiple defined in 4 places.'>getOneItem</a>($<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a>);
<a name='L42'>  42 
<a name='L43'>  43                                 <i><font color='green'>//Count registrations</font></i>
<a name='L44'>  44                                 $<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a> = 'SELECT COUNT(*) FROM tblUsers WHERE timeCreated BETWEEN "'.<a href='../S/19.html#L403' title='Defined at 403 in class.DB_Base.php.'>sql_datetime</a>($<a href='../Y/634.html' title='Multiple used in 7 places.'>time_start</a>).'" AND "'.<a href='../S/19.html#L403' title='Defined at 403 in class.DB_Base.php.'>sql_datetime</a>($<a href='../Y/629.html' title='Multiple used in 5 places.'>time_end</a>).'"';
<a name='L45'>  45                                 $<a href='../Y/527.html' title='Multiple used in 2 places.'>registrations</a> = $<a href='../Y/173.html' title='Multiple used in 576 places.'>db</a>-&gt;<a href='../D/204.html' title='Multiple defined in 4 places.'>getOneItem</a>($<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a>);
<a name='L46'>  46 
<a name='L47'>  47                                 <i><font color='green'>//Store information</font></i>
<a name='L48'>  48                                 $<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a> = 'INSERT INTO tblStatistics SET time="'.<a href='../S/19.html#L403' title='Defined at 403 in class.DB_Base.php.'>sql_datetime</a>($<a href='../Y/634.html' title='Multiple used in 7 places.'>time_start</a>).'",logins='.$<a href='../Y/352.html' title='Multiple used in 2 places.'>logins</a>.',registrations='.$<a href='../Y/527.html' title='Multiple used in 2 places.'>registrations</a>;
<a name='L49'>  49                                 $<a href='../Y/173.html' title='Multiple used in 576 places.'>db</a>-&gt;<a href='../D/250.html' title='Multiple defined in 4 places.'>insert</a>($<a href='../Y/505.html' title='Multiple used in 705 places.'>q</a>);
<a name='L50'>  50                         <font color='blue'>}</font>
<a name='L51'>  51                 <font color='blue'>}</font>
<a name='L52'>  52         <font color='blue'>}</font>
<a name='L53'>  53 
<a name='L54'>  54 ?&gt;
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L10'>[^]</a><a href='#L19'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
